---
layout: post
title: ubuntu下DNS的修改
date: 2017-04-25 12:27:00
categories: Linux
tag: DNS
---

* content
{:toc}


## 1.查看resolv.conf
打开/etc/resolv.conf
```
cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
```

内容是一段警告：说这个文件是resolvconf程序动态创建的，不要直接手动编辑，修改将被覆盖。

## 2.方法一 通过/etc/network/interfaces
打开/etc/network/interfaces,在它的最后增加一句：
```
# ipv6 dns
nameserver 2001:250:1001::23  # 或dns-nameserver
nameserver 2001:470:20::2
nameserver 2001:778::372001:4860:4860::8844
```

重启后DNS就生效了，这时候再看/etc/resolv.conf，最下面就多了一行：
```
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 2001:250:1001::23 
nameserver 2001:470:20::2
nameserver 2001:778::372001:4860:4860::8844
```

## 3.方法二 通过/etc/resolvconf/resolv.conf.d/base
这个文件默认是空的，打开后在里面插入：
```
nameserver 8.8.8.8
nameserver 8.8.4.4
```

如果有多个DNS就一行一个

修改好保存，然后执行

resolvconf -u

再看/etc/resolv.conf，最下面就多了2行：
```
cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 8.8.8.8
nameserver 8.8.4.4
```

可以看到我们的设置已经加上了，然后再ping一个域名，当时就可以解析了，无需重启。

附：CentOS下修改DNS则容易的多了，直接修改/etc/resolv.conf，内容是：
nameserver 8.8.8.8
nameserver 8.8.4.4

保存就生效了，重启也没问题。
